import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.net.DatagramPacket;
import java.net.InetAddress;
import java.net.MulticastSocket;

public class ReceptorUDPMulticast {

	public static void main(String[] args) {
		try {
			MulticastSocket ms = new MulticastSocket( 4321 );
			//Obtenemos una IP de multicast, tambien llamada grupos, 
			//por que varios equipos pueden escuchar de esa IP
			InetAddress grupo = InetAddress.getByName("224.0.0.1");
			ms.joinGroup( grupo );//el socket ya se encuentra escuchando cualquier dato
			//recepcion de paquete
			DatagramPacket paqueteRecibido = new DatagramPacket(new byte[1024], 1024);
			ms.receive( paqueteRecibido );
			ByteArrayInputStream bis = new ByteArrayInputStream( paqueteRecibido.getData() );
			ObjectInputStream ois = new ObjectInputStream( bis );
			Mensaje mensajeRecibido = (Mensaje) ois.readObject();
			ois.close();
			bis.close();
			System.out.println( "mensaje recibido: " + mensajeRecibido );
		} catch (IOException | ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}
